---
title: Depositing Assets
order: 2
---

# Depositing Assets

There are two ways to deposit assets into a T3tris vault, depending on whether the vault is **open** (synchronous) or **closed** (asynchronous).

## Synchronous Deposits (Open Vault)

When the vault is open, deposits work like a standard ERC-4626 vault — you deposit assets and receive shares instantly.

### `deposit(assets, receiver)`

Deposit a specific amount of **assets** and receive shares proportional to the current PPS.

```solidity
// Approve the vault to spend your tokens
IERC20(asset).approve(vault, amount);

// Deposit and receive shares
uint256 sharesReceived = IVault(vault).deposit(amount, yourAddress);
```

### `mint(shares, receiver)`

Alternatively, specify the exact number of **shares** you want and the vault calculates how many assets are required.

```solidity
// Check how many assets are needed for the desired shares
uint256 assetsNeeded = IVault(vault).previewMint(desiredShares);

// Approve and mint
IERC20(asset).approve(vault, assetsNeeded);
uint256 assetsSpent = IVault(vault).mint(desiredShares, yourAddress);
```

### With Permit2

Both functions accept an optional `permit2Data` parameter for gasless approvals:

```solidity
uint256 shares = IVault(vault).deposit(amount, yourAddress, permit2Data);
uint256 assets = IVault(vault).mint(desiredShares, yourAddress, permit2Data);
```

### Preview Functions

Before depositing, you can preview the expected outcome:

```solidity
// How many shares will I receive for `assets`?
uint256 expectedShares = IVault(vault).previewDeposit(assets);

// How many assets do I need for `shares`?
uint256 requiredAssets = IVault(vault).previewMint(shares);
```

### Limits

```solidity
// Maximum amount you can deposit
uint256 maxAssets = IVault(vault).maxDeposit(yourAddress);

// Maximum shares you can mint
uint256 maxShares = IVault(vault).maxMint(yourAddress);
```

These return `0` when:

- The vault is closed (use async deposit instead)
- Deposits are disabled
- The vault is paused
- You are not whitelisted (for vaults with deposit whitelists)
- End of Fund mode is active (no new deposits allowed)

---

## Asynchronous Deposits (Closed Vault)

When the vault is closed, deposits happen in two steps:

1. **Request**: You submit your deposit request — assets are transferred to the deposit silo
2. **Claim**: After the asset manager settles the request, you claim your shares

### Step 1: Request a Deposit

```solidity
// Approve and request deposit
IERC20(asset).approve(vault, amount);
IVault(vault).requestDeposit(amount, yourAddress);
```

Your assets are now held in the **deposit silo**, which may generate yield while you wait. Any yield generated by the deposit silo goes to the T3tris treasury — you neither benefit from nor bear the risk of silo yield.

### Step 2: Wait for Settlement

The asset manager periodically runs **settlement**, which:

1. Calculates the current NAV
2. Computes fees (entry, management, performance)
3. Mints shares at the settlement price for all pending deposits
4. Transfers net assets to the asset manager

You can check if your deposit has been settled:

```solidity
bool canClaim = IVault(vault).hasClaimableDeposit(yourAddress);
```

### Step 3: Claim Your Shares

Once settled, claim your shares:

```solidity
uint256 sharesReceived = IVault(vault).claimDeposit(yourAddress);
```

### Preview Before Claiming

```solidity
uint256 expectedShares = IVault(vault).previewClaimDeposit(yourAddress);
```

### Decreasing a Pending Request

If you change your mind **before settlement**, you can reduce or cancel your pending deposit:

```solidity
// Decrease by a partial amount
IVault(vault).decreaseDepositRequest(partialAmount, yourAddress);

// Cancel entirely (decrease by the full pending amount)
IVault(vault).decreaseDepositRequest(fullPendingAmount, yourAddress);
```

This returns the assets back to you from the deposit silo.

> **Important:** You can only decrease a deposit request _before_ settlement. Once settled, you must claim the shares.

### Auto-Claim on New Request

If you have unclaimed shares from a previous settlement and you make a new deposit request, the protocol **automatically claims** your outstanding shares before processing the new request.

---

## Deposit Lifecycle Diagram

```
OPEN VAULT (Synchronous)
═══════════════════════════
  You ──deposit()──▶ Vault ──▶ Shares returned instantly


CLOSED VAULT (Asynchronous)
═══════════════════════════
  1. You ──requestDeposit()──▶ DepositSilo (assets held)
  2. Asset Manager ──settle()──▶ Shares minted
  3. You ──claimDeposit()──▶ Shares transferred to you
```

## Entry Fees

When depositing into a vault with an entry fee, the fee is deducted from your deposit at settlement time:

```
deposited assets = 10,000 USDC
entry fee = 1% (100 bps)

net deposit = 10,000 × (1 - 0.01) = 9,900 USDC
shares received = 9,900 / PPS
fee shares = 100 / PPS (minted to fee recipient)
```

For synchronous deposits, entry fees are applied immediately. For async deposits, entry fees are applied during settlement.

You can check the current entry fee:

```solidity
uint16 entryFeeBps = IVault(vault).getEntryFeeBps();
// 100 = 1%, 50 = 0.5%, 0 = no fee
```
